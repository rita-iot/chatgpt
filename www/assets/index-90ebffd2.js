import{r as v,R as x,N as V,Q as Z,T as J,C as ee,U as te,c as se,V as oe,B as I,W as ne,X as ae,Y as ie,Z as T,j as d,q as re,s as le,$ as ce,O as D,b as O,I as de,J as U,m as z,a0 as ue,d as he,f as fe,a1 as ge,a2 as _e,a3 as pe,a4 as me,a5 as ye}from"./index-3f2f9d15.js";import{U as Ce}from"./index-0908c512.js";import{L as Ee,S as Me}from"./index-609a3100.js";var we=Object.defineProperty,j=Object.getOwnPropertySymbols,H=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable,Q=(r,n,c)=>n in r?we(r,n,{enumerable:!0,configurable:!0,writable:!0,value:c}):r[n]=c,$=(r,n)=>{for(var c in n||(n={}))H.call(n,c)&&Q(r,c,n[c]);if(j)for(var c of j(n))G.call(n,c)&&Q(r,c,n[c]);return r},Pe=(r,n)=>{var c={};for(var i in r)H.call(r,i)&&n.indexOf(i)<0&&(c[i]=r[i]);if(r!=null&&j)for(var i of j(r))n.indexOf(i)<0&&G.call(r,i)&&(c[i]=r[i]);return c};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var L;(r=>{const n=class{constructor(e,s,t,o){if(this.version=e,this.errorCorrectionLevel=s,this.modules=[],this.isFunction=[],e<n.MIN_VERSION||e>n.MAX_VERSION)throw new RangeError("Version value out of range");if(o<-1||o>7)throw new RangeError("Mask value out of range");this.size=e*4+17;let a=[];for(let l=0;l<this.size;l++)a.push(!1);for(let l=0;l<this.size;l++)this.modules.push(a.slice()),this.isFunction.push(a.slice());this.drawFunctionPatterns();const u=this.addEccAndInterleave(t);if(this.drawCodewords(u),o==-1){let l=1e9;for(let C=0;C<8;C++){this.applyMask(C),this.drawFormatBits(C);const g=this.getPenaltyScore();g<l&&(o=C,l=g),this.applyMask(C)}}h(0<=o&&o<=7),this.mask=o,this.applyMask(o),this.drawFormatBits(o),this.isFunction=[]}static encodeText(e,s){const t=r.QrSegment.makeSegments(e);return n.encodeSegments(t,s)}static encodeBinary(e,s){const t=r.QrSegment.makeBytes(e);return n.encodeSegments([t],s)}static encodeSegments(e,s,t=1,o=40,a=-1,u=!0){if(!(n.MIN_VERSION<=t&&t<=o&&o<=n.MAX_VERSION)||a<-1||a>7)throw new RangeError("Invalid value");let l,C;for(l=t;;l++){const _=n.getNumDataCodewords(l,s)*8,f=m.getTotalBits(e,l);if(f<=_){C=f;break}if(l>=o)throw new RangeError("Data too long")}for(const _ of[n.Ecc.MEDIUM,n.Ecc.QUARTILE,n.Ecc.HIGH])u&&C<=n.getNumDataCodewords(l,_)*8&&(s=_);let g=[];for(const _ of e){i(_.mode.modeBits,4,g),i(_.numChars,_.mode.numCharCountBits(l),g);for(const f of _.getData())g.push(f)}h(g.length==C);const N=n.getNumDataCodewords(l,s)*8;h(g.length<=N),i(0,Math.min(4,N-g.length),g),i(0,(8-g.length%8)%8,g),h(g.length%8==0);for(let _=236;g.length<N;_^=253)i(_,8,g);let M=[];for(;M.length*8<g.length;)M.push(0);return g.forEach((_,f)=>M[f>>>3]|=_<<7-(f&7)),new n(l,s,M,a)}getModule(e,s){return 0<=e&&e<this.size&&0<=s&&s<this.size&&this.modules[s][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let t=0;t<this.size;t++)this.setFunctionModule(6,t,t%2==0),this.setFunctionModule(t,6,t%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),s=e.length;for(let t=0;t<s;t++)for(let o=0;o<s;o++)t==0&&o==0||t==0&&o==s-1||t==s-1&&o==0||this.drawAlignmentPattern(e[t],e[o]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const s=this.errorCorrectionLevel.formatBits<<3|e;let t=s;for(let a=0;a<10;a++)t=t<<1^(t>>>9)*1335;const o=(s<<10|t)^21522;h(o>>>15==0);for(let a=0;a<=5;a++)this.setFunctionModule(8,a,y(o,a));this.setFunctionModule(8,7,y(o,6)),this.setFunctionModule(8,8,y(o,7)),this.setFunctionModule(7,8,y(o,8));for(let a=9;a<15;a++)this.setFunctionModule(14-a,8,y(o,a));for(let a=0;a<8;a++)this.setFunctionModule(this.size-1-a,8,y(o,a));for(let a=8;a<15;a++)this.setFunctionModule(8,this.size-15+a,y(o,a));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let t=0;t<12;t++)e=e<<1^(e>>>11)*7973;const s=this.version<<12|e;h(s>>>18==0);for(let t=0;t<18;t++){const o=y(s,t),a=this.size-11+t%3,u=Math.floor(t/3);this.setFunctionModule(a,u,o),this.setFunctionModule(u,a,o)}}drawFinderPattern(e,s){for(let t=-4;t<=4;t++)for(let o=-4;o<=4;o++){const a=Math.max(Math.abs(o),Math.abs(t)),u=e+o,l=s+t;0<=u&&u<this.size&&0<=l&&l<this.size&&this.setFunctionModule(u,l,a!=2&&a!=4)}}drawAlignmentPattern(e,s){for(let t=-2;t<=2;t++)for(let o=-2;o<=2;o++)this.setFunctionModule(e+o,s+t,Math.max(Math.abs(o),Math.abs(t))!=1)}setFunctionModule(e,s,t){this.modules[s][e]=t,this.isFunction[s][e]=!0}addEccAndInterleave(e){const s=this.version,t=this.errorCorrectionLevel;if(e.length!=n.getNumDataCodewords(s,t))throw new RangeError("Invalid argument");const o=n.NUM_ERROR_CORRECTION_BLOCKS[t.ordinal][s],a=n.ECC_CODEWORDS_PER_BLOCK[t.ordinal][s],u=Math.floor(n.getNumRawDataModules(s)/8),l=o-u%o,C=Math.floor(u/o);let g=[];const N=n.reedSolomonComputeDivisor(a);for(let _=0,f=0;_<o;_++){let E=e.slice(f,f+C-a+(_<l?0:1));f+=E.length;const w=n.reedSolomonComputeRemainder(E,N);_<l&&E.push(0),g.push(E.concat(w))}let M=[];for(let _=0;_<g[0].length;_++)g.forEach((f,E)=>{(_!=C-a||E>=l)&&M.push(f[_])});return h(M.length==u),M}drawCodewords(e){if(e.length!=Math.floor(n.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let s=0;for(let t=this.size-1;t>=1;t-=2){t==6&&(t=5);for(let o=0;o<this.size;o++)for(let a=0;a<2;a++){const u=t-a,C=(t+1&2)==0?this.size-1-o:o;!this.isFunction[C][u]&&s<e.length*8&&(this.modules[C][u]=y(e[s>>>3],7-(s&7)),s++)}}h(s==e.length*8)}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let s=0;s<this.size;s++)for(let t=0;t<this.size;t++){let o;switch(e){case 0:o=(t+s)%2==0;break;case 1:o=s%2==0;break;case 2:o=t%3==0;break;case 3:o=(t+s)%3==0;break;case 4:o=(Math.floor(t/3)+Math.floor(s/2))%2==0;break;case 5:o=t*s%2+t*s%3==0;break;case 6:o=(t*s%2+t*s%3)%2==0;break;case 7:o=((t+s)%2+t*s%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[s][t]&&o&&(this.modules[s][t]=!this.modules[s][t])}}getPenaltyScore(){let e=0;for(let a=0;a<this.size;a++){let u=!1,l=0,C=[0,0,0,0,0,0,0];for(let g=0;g<this.size;g++)this.modules[a][g]==u?(l++,l==5?e+=n.PENALTY_N1:l>5&&e++):(this.finderPenaltyAddHistory(l,C),u||(e+=this.finderPenaltyCountPatterns(C)*n.PENALTY_N3),u=this.modules[a][g],l=1);e+=this.finderPenaltyTerminateAndCount(u,l,C)*n.PENALTY_N3}for(let a=0;a<this.size;a++){let u=!1,l=0,C=[0,0,0,0,0,0,0];for(let g=0;g<this.size;g++)this.modules[g][a]==u?(l++,l==5?e+=n.PENALTY_N1:l>5&&e++):(this.finderPenaltyAddHistory(l,C),u||(e+=this.finderPenaltyCountPatterns(C)*n.PENALTY_N3),u=this.modules[g][a],l=1);e+=this.finderPenaltyTerminateAndCount(u,l,C)*n.PENALTY_N3}for(let a=0;a<this.size-1;a++)for(let u=0;u<this.size-1;u++){const l=this.modules[a][u];l==this.modules[a][u+1]&&l==this.modules[a+1][u]&&l==this.modules[a+1][u+1]&&(e+=n.PENALTY_N2)}let s=0;for(const a of this.modules)s=a.reduce((u,l)=>u+(l?1:0),s);const t=this.size*this.size,o=Math.ceil(Math.abs(s*20-t*10)/t)-1;return h(0<=o&&o<=9),e+=o*n.PENALTY_N4,h(0<=e&&e<=2568888),e}getAlignmentPatternPositions(){if(this.version==1)return[];{const e=Math.floor(this.version/7)+2,s=this.version==32?26:Math.ceil((this.version*4+4)/(e*2-2))*2;let t=[6];for(let o=this.size-7;t.length<e;o-=s)t.splice(1,0,o);return t}}static getNumRawDataModules(e){if(e<n.MIN_VERSION||e>n.MAX_VERSION)throw new RangeError("Version number out of range");let s=(16*e+128)*e+64;if(e>=2){const t=Math.floor(e/7)+2;s-=(25*t-10)*t-55,e>=7&&(s-=36)}return h(208<=s&&s<=29648),s}static getNumDataCodewords(e,s){return Math.floor(n.getNumRawDataModules(e)/8)-n.ECC_CODEWORDS_PER_BLOCK[s.ordinal][e]*n.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw new RangeError("Degree out of range");let s=[];for(let o=0;o<e-1;o++)s.push(0);s.push(1);let t=1;for(let o=0;o<e;o++){for(let a=0;a<s.length;a++)s[a]=n.reedSolomonMultiply(s[a],t),a+1<s.length&&(s[a]^=s[a+1]);t=n.reedSolomonMultiply(t,2)}return s}static reedSolomonComputeRemainder(e,s){let t=s.map(o=>0);for(const o of e){const a=o^t.shift();t.push(0),s.forEach((u,l)=>t[l]^=n.reedSolomonMultiply(u,a))}return t}static reedSolomonMultiply(e,s){if(e>>>8||s>>>8)throw new RangeError("Byte out of range");let t=0;for(let o=7;o>=0;o--)t=t<<1^(t>>>7)*285,t^=(s>>>o&1)*e;return h(t>>>8==0),t}finderPenaltyCountPatterns(e){const s=e[1];h(s<=this.size*3);const t=s>0&&e[2]==s&&e[3]==s*3&&e[4]==s&&e[5]==s;return(t&&e[0]>=s*4&&e[6]>=s?1:0)+(t&&e[6]>=s*4&&e[0]>=s?1:0)}finderPenaltyTerminateAndCount(e,s,t){return e&&(this.finderPenaltyAddHistory(s,t),s=0),s+=this.size,this.finderPenaltyAddHistory(s,t),this.finderPenaltyCountPatterns(t)}finderPenaltyAddHistory(e,s){s[0]==0&&(e+=this.size),s.pop(),s.unshift(e)}};let c=n;c.MIN_VERSION=1,c.MAX_VERSION=40,c.PENALTY_N1=3,c.PENALTY_N2=3,c.PENALTY_N3=40,c.PENALTY_N4=10,c.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],c.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],r.QrCode=c;function i(e,s,t){if(s<0||s>31||e>>>s)throw new RangeError("Value out of range");for(let o=s-1;o>=0;o--)t.push(e>>>o&1)}function y(e,s){return(e>>>s&1)!=0}function h(e){if(!e)throw new Error("Assertion error")}const p=class{constructor(e,s,t){if(this.mode=e,this.numChars=s,this.bitData=t,s<0)throw new RangeError("Invalid argument");this.bitData=t.slice()}static makeBytes(e){let s=[];for(const t of e)i(t,8,s);return new p(p.Mode.BYTE,e.length,s)}static makeNumeric(e){if(!p.isNumeric(e))throw new RangeError("String contains non-numeric characters");let s=[];for(let t=0;t<e.length;){const o=Math.min(e.length-t,3);i(parseInt(e.substr(t,o),10),o*3+1,s),t+=o}return new p(p.Mode.NUMERIC,e.length,s)}static makeAlphanumeric(e){if(!p.isAlphanumeric(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");let s=[],t;for(t=0;t+2<=e.length;t+=2){let o=p.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t))*45;o+=p.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t+1)),i(o,11,s)}return t<e.length&&i(p.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t)),6,s),new p(p.Mode.ALPHANUMERIC,e.length,s)}static makeSegments(e){return e==""?[]:p.isNumeric(e)?[p.makeNumeric(e)]:p.isAlphanumeric(e)?[p.makeAlphanumeric(e)]:[p.makeBytes(p.toUtf8ByteArray(e))]}static makeEci(e){let s=[];if(e<0)throw new RangeError("ECI assignment value out of range");if(e<128)i(e,8,s);else if(e<16384)i(2,2,s),i(e,14,s);else if(e<1e6)i(6,3,s),i(e,21,s);else throw new RangeError("ECI assignment value out of range");return new p(p.Mode.ECI,0,s)}static isNumeric(e){return p.NUMERIC_REGEX.test(e)}static isAlphanumeric(e){return p.ALPHANUMERIC_REGEX.test(e)}getData(){return this.bitData.slice()}static getTotalBits(e,s){let t=0;for(const o of e){const a=o.mode.numCharCountBits(s);if(o.numChars>=1<<a)return 1/0;t+=4+a+o.bitData.length}return t}static toUtf8ByteArray(e){e=encodeURI(e);let s=[];for(let t=0;t<e.length;t++)e.charAt(t)!="%"?s.push(e.charCodeAt(t)):(s.push(parseInt(e.substr(t+1,2),16)),t+=2);return s}};let m=p;m.NUMERIC_REGEX=/^[0-9]*$/,m.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,m.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",r.QrSegment=m})(L||(L={}));(r=>{(n=>{const c=class{constructor(y,h){this.ordinal=y,this.formatBits=h}};let i=c;i.LOW=new c(0,1),i.MEDIUM=new c(1,0),i.QUARTILE=new c(2,3),i.HIGH=new c(3,2),n.Ecc=i})(r.QrCode||(r.QrCode={}))})(L||(L={}));(r=>{(n=>{const c=class{constructor(y,h){this.modeBits=y,this.numBitsCharCount=h}numCharCountBits(y){return this.numBitsCharCount[Math.floor((y+7)/17)]}};let i=c;i.NUMERIC=new c(1,[10,12,14]),i.ALPHANUMERIC=new c(2,[9,11,13]),i.BYTE=new c(4,[8,16,16]),i.KANJI=new c(8,[8,10,12]),i.ECI=new c(7,[0,0,0]),n.Mode=i})(r.QrSegment||(r.QrSegment={}))})(L||(L={}));var A=L;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var ve={L:A.QrCode.Ecc.LOW,M:A.QrCode.Ecc.MEDIUM,Q:A.QrCode.Ecc.QUARTILE,H:A.QrCode.Ecc.HIGH},Re=128,xe="L",Ne="#FFFFFF",Se="#000000",Le=!1,Y=4,be=.1;function Ae(r,n=0){const c=[];return r.forEach(function(i,y){let h=null;i.forEach(function(p,m){if(!p&&h!==null){c.push(`M${h+n} ${y+n}h${m-h}v1H${h+n}z`),h=null;return}if(m===i.length-1){if(!p)return;h===null?c.push(`M${m+n},${y+n} h1v1H${m+n}z`):c.push(`M${h+n},${y+n} h${m+1-h}v1H${h+n}z`);return}p&&h===null&&(h=m)})}),c.join("")}function Ie(r,n){return r.slice().map((c,i)=>i<n.y||i>=n.y+n.h?c:c.map((y,h)=>h<n.x||h>=n.x+n.w?y:!1))}function je(r,n,c,i){if(i==null)return null;const y=c?Y:0,h=r.length+y*2,p=Math.floor(n*be),m=h/n,e=(i.width||p)*m,s=(i.height||p)*m,t=i.x==null?r.length/2-e/2:i.x*m,o=i.y==null?r.length/2-s/2:i.y*m;let a=null;if(i.excavate){let u=Math.floor(t),l=Math.floor(o),C=Math.ceil(e+t-u),g=Math.ceil(s+o-l);a={x:u,y:l,w:C,h:g}}return{x:t,y:o,h:s,w:e,excavation:a}}var Oe=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}();function ze(r){const n=r,{value:c,size:i=Re,level:y=xe,bgColor:h=Ne,fgColor:p=Se,includeMargin:m=Le,style:e,imageSettings:s}=n,t=Pe(n,["value","size","level","bgColor","fgColor","includeMargin","style","imageSettings"]),o=s==null?void 0:s.src,a=v.useRef(null),u=v.useRef(null),[l,C]=v.useState(!1);v.useEffect(()=>{if(a.current!=null){const M=a.current,_=M.getContext("2d");if(!_)return;let f=A.QrCode.encodeText(c,ve[y]).getModules();const E=m?Y:0,w=f.length+E*2,P=je(f,i,m,s),b=u.current,F=P!=null&&b!==null&&b.complete&&b.naturalHeight!==0&&b.naturalWidth!==0;F&&P.excavation!=null&&(f=Ie(f,P.excavation));const B=window.devicePixelRatio||1;M.height=M.width=i*B;const k=i/w*B;_.scale(k,k),_.fillStyle=h,_.fillRect(0,0,w,w),_.fillStyle=p,Oe?_.fill(new Path2D(Ae(f,E))):f.forEach(function(q,X){q.forEach(function(W,K){W&&_.fillRect(K+E,X+E,1,1)})}),F&&_.drawImage(b,P.x+E,P.y+E,P.w,P.h)}}),v.useEffect(()=>{C(!1)},[o]);const g=$({height:i,width:i},e);let N=null;return o!=null&&(N=x.createElement("img",{src:o,key:o,style:{display:"none"},onLoad:()=>{C(!0)},ref:u})),x.createElement(x.Fragment,null,x.createElement("canvas",$({style:g,height:i,width:i,ref:a},t)),N)}const Te=r=>{const{componentCls:n}=r;return{[n]:Object.assign(Object.assign({},J(r)),{display:"flex",justifyContent:"center",alignItems:"center",padding:r.paddingSM,backgroundColor:r.colorWhite,borderRadius:r.borderRadiusLG,border:`${r.lineWidth}px ${r.lineType} ${r.colorSplit}`,position:"relative",width:"100%",height:"100%",overflow:"hidden",[`& > ${n}-mask`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,zIndex:10,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",color:r.colorText,lineHeight:r.lineHeight,background:r.QRCodeMaskBackgroundColor,textAlign:"center",[`& > ${n}-expired`]:{color:r.QRCodeExpiredTextColor}},"&-icon":{marginBlockEnd:r.marginXS,fontSize:r.controlHeight}}),[`${n}-borderless`]:{borderColor:"transparent"}}},Fe=V("QRCode",r=>Te(Z(r,{QRCodeExpiredTextColor:"rgba(0, 0, 0, 0.88)",QRCodeMaskBackgroundColor:"rgba(255, 255, 255, 0.96)"}))),{useToken:Be}=ae,ke=r=>{const{value:n,icon:c="",size:i=160,iconSize:y=40,color:h="#000",errorLevel:p="M",status:m="active",bordered:e=!0,onRefresh:s,style:t,className:o,rootClassName:a,prefixCls:u,bgColor:l="transparent"}=r,{getPrefixCls:C}=v.useContext(ee),g=C("qrcode",u),[N,M]=Fe(g),{token:_}=Be(),f=v.useMemo(()=>{const P={src:c,x:void 0,y:void 0,height:y,width:y,excavate:!0};return{value:n,size:i-(_.paddingSM+_.lineWidth)*2,level:p,bgColor:l,fgColor:h,imageSettings:c?P:void 0}},[p,h,c,y,i,n,l]),[E]=te("QRCode");if(!n)return null;const w=se(g,o,a,M,{[`${g}-borderless`]:!e});return N(x.createElement("div",{style:Object.assign(Object.assign({},t),{width:i,height:i,backgroundColor:l}),className:w},m!=="active"&&x.createElement("div",{className:`${g}-mask`},m==="loading"&&x.createElement(oe,null),m==="expired"&&x.createElement(x.Fragment,null,x.createElement("p",{className:`${g}-expired`},E==null?void 0:E.expired),s&&x.createElement(I,{type:"link",icon:x.createElement(ne,null),onClick:s},E==null?void 0:E.refresh))),x.createElement(ze,Object.assign({},f))))},De=ke;async function Ue(){const r=await ie();if(!r.code){T.getState().changeGoodsList([...r.data.products]);const n=r.data.pay_types.map(c=>({wxpay:{icon:"https://files.catbox.moe/b1joiq.png",title:"微信支付",key:"wxpay"},alipay:{icon:"https://files.catbox.moe/a8x6il.png",title:"支付宝",key:"alipay"},qqpay:{icon:"https://files.catbox.moe/rimuzz.png",title:"QQ支付",key:"qqpay"}})[c]);await T.getState().changePayTypes([...n])}return r}const Qe={fetchProduct:Ue},$e="_goodsPay_container_16fec_1",He="_goodsPay_card_16fec_12",Ge="_goodsPay_16fec_1",Ye="_goodsPay_pagination_16fec_26",qe="_goodsPay_pay_16fec_33",Xe="_goodsPay_pay_type_16fec_38",We="_goodsPay_pay_type_select_16fec_53",Ke="_payModal_16fec_56",Ve="_payModal_icon_16fec_65",Ze="_payModal_paylogo_16fec_69",Je="_payModal_message_16fec_72",et="_payModal_button_16fec_83",R={goodsPay_container:$e,goodsPay_card:He,goodsPay:Ge,goodsPay_pagination:Ye,goodsPay_pay:qe,goodsPay_pay_type:Xe,goodsPay_pay_type_select:We,payModal:Ke,payModal_icon:Ve,payModal_paylogo:Ze,payModal_message:Je,payModal_button:et},tt="_goodsList_1oq5r_1",st="_goodsList_item_1oq5r_6",ot="_goodsList_item_select_1oq5r_24",nt="_goodsList_item_tag_1oq5r_31",at="_goodsList_item_level_1oq5r_41",it="_goodsList_item_price_1oq5r_46",rt="_sales_price_1oq5r_50",lt="_original_price_1oq5r_55",S={goodsList:tt,goodsList_item:st,goodsList_item_select:ot,goodsList_item_tag:nt,goodsList_item_level:at,goodsList_item_price:it,sales_price:rt,original_price:lt};function ct(r){const[n,c]=v.useState();return v.useEffect(()=>{var i;n&&n.id&&((i=r.onChange)==null||i.call(r,n))},[n]),d.jsx("div",{className:S.goodsList,children:r.list.map(i=>{const y=(n==null?void 0:n.id)===i.id?`${S.goodsList_item} ${S.goodsList_item_select}`:S.goodsList_item;return d.jsxs("div",{className:y,onClick:()=>{c(i)},children:[d.jsx("p",{className:S.goodsList_item_level,children:i.level===1?"会员":i.level===2?"超级会员":"超级特惠"}),i.type==="integral"?d.jsxs("h3",{children:[i.value,"积分"]}):d.jsxs("h3",{children:[i.value,"天"]}),d.jsxs("div",{className:S.goodsList_item_price,children:[d.jsxs("p",{className:S.sales_price,children:[(i.price/100).toFixed(2),d.jsx("span",{children:"元"})]}),i.original_price&&d.jsxs("p",{className:S.original_price,children:["¥",(i.original_price/100).toFixed(2)]})]}),d.jsx("span",{className:S.goodsList_item_tag,children:i.badge})]},i.id)})})}function ft(){const{goodsList:r,payTypes:n}=T(),{token:c,user_info:i}=re(),{shop_introduce:y}=le(),[h,p]=v.useState(),[m,e]=v.useState(""),s={wxpay:{icon:"https://files.catbox.moe/b1joiq.png",message:"请使用微信扫码支付",color:"#24aa39"},alipay:{icon:"https://files.catbox.moe/a8x6il.png",message:"请使用支付宝扫码支付",color:"#1678ff"},qqpay:{icon:"https://files.catbox.moe/rimuzz.png",message:"请使用QQ扫码支付",color:"#10b8f6"}},[t,o]=v.useState({page:1,pageSize:10,loading:!1,rows:[],count:1}),[a,u]=v.useState({open:!1,status:"pay",order_id:"",pay_url:"sdsgsdgsdg"});v.useEffect(()=>{Qe.fetchProduct(),l(t.page,t.pageSize)},[]);function l(f,E){o(w=>({...w,page:f,pageSize:E,loading:!0})),ce({page:f,page_size:E}).then(w=>{w.code||o(P=>({...P,page:f,...w.data,loading:!1}))}).finally(()=>{o(w=>({...w,page:f,loading:!1}))})}async function C(f,E){u(P=>({...P,open:!0}));const w=await pe({pay_type:E,product_id:f.id,quantity:1});if(w.code){u(P=>({...P,status:"fail"}));return}u(P=>({...P,status:"pay",...w.data}))}function g(){l(1,t.pageSize),u(f=>({...f,status:"loading",open:!1}))}const[N,M]=v.useState(!1);function _(f){if(!f){z.warning("请输入卡密");return}M(!0),me({carmi:f}).then(E=>{E.code||(ye.fetchUserInfo(),z.success(E.message),l(1,t.pageSize))}).finally(()=>{M(!1)})}return c?d.jsx("div",{className:R.goodsPay,children:d.jsx(Ee,{children:d.jsxs("div",{className:R.goodsPay_container,children:[d.jsxs(O,{direction:"vertical",style:{width:"100%"},children:[d.jsx(Ce,{info:i}),d.jsxs("div",{className:R.goodsPay_card,children:[d.jsx("h4",{children:"卡密充值"}),d.jsx(de.Search,{loading:N,placeholder:"请输入充值卡密",allowClear:!0,enterButton:"充值",size:"large",bordered:!0,onSearch:_})]}),y&&d.jsxs("div",{className:R.goodsPay_card,children:[d.jsx("h4",{children:"商品说明"}),d.jsx("div",{dangerouslySetInnerHTML:{__html:y}})]}),r.length>0&&d.jsxs("div",{className:R.goodsPay_card,children:[d.jsx("h4",{children:"在线充值"}),d.jsx(ct,{list:r,onChange:f=>{p(f)}}),d.jsxs("div",{className:R.goodsPay_pay,children:[d.jsx(U.Group,{onChange:f=>{e(f.target.value)},children:d.jsx(O,{size:"middle",wrap:!0,children:n.map(f=>d.jsx("div",{className:R.goodsPay_pay_type,style:{borderColor:f.key===m?"#1677ff":"#999"},children:d.jsx(U,{value:f.key,children:d.jsx("img",{src:f.icon,alt:f.title})})},f.key))})}),d.jsx(I,{size:"large",style:{marginLeft:"auto"},type:"primary",disabled:!(h!=null&&h.id&&m),onClick:()=>{h&&h.id&&m?C(h,m):z.warning("请选择商品和支付方式")},children:"立即充值"})]})]}),d.jsxs("div",{className:R.goodsPay_card,children:[d.jsxs("h4",{onClick:()=>{l(1,t.pageSize)},children:["订单记录 ",d.jsx(Me,{spin:t.loading})]}),d.jsx(ue,{scroll:{x:800},bordered:!0,loading:t.loading,dataSource:t.rows,pagination:!1,rowKey:"id",columns:[{title:"描述",dataIndex:"describe",key:"describe"},{title:"额度",key:"value",render:f=>d.jsx("a",{children:f.value},f.value)},{title:"日期",dataIndex:"create_time",key:"create_time"}]}),d.jsx("div",{className:R.goodsPay_pagination,children:d.jsx(he,{size:"small",current:t.page,defaultCurrent:t.page,defaultPageSize:t.pageSize,total:t.count,onChange:(f,E)=>{l(f,E)},hideOnSinglePage:!0})})]})]}),d.jsx(fe,{open:a.open,onCancel:()=>{u({open:!1,status:"loading"})},footer:null,width:320,children:d.jsxs("div",{className:R.payModal,children:[a.status==="fail"&&d.jsx(ge,{className:R.payModal_icon}),a.status==="loading"&&d.jsx(D,{rotate:!0,width:"3em",height:"3em"}),a.status==="pay"&&m&&d.jsx("img",{className:R.payModal_paylogo,src:s[m].icon,alt:"",srcSet:""}),a.status==="pay"&&a.pay_url&&m&&d.jsx(_e,{to:a.pay_url,target:"_blank",children:d.jsx(De,{value:a.pay_url,color:s[m].color,style:{marginTop:16}})}),m&&d.jsx("div",{className:R.payModal_message,children:a.status==="fail"?d.jsx("p",{children:"创建订单失败，请重新尝试"}):a.status==="pay"&&s&&h?d.jsxs("p",{children:[d.jsxs("span",{children:[((h==null?void 0:h.price)/100).toFixed(2),"元"]}),d.jsx("br",{}),s[m].message]}):d.jsx("p",{children:"正在创建订单中..."})}),d.jsx("div",{className:R.payModal_button,children:a.status==="pay"&&d.jsxs(O,{children:[d.jsx(I,{danger:!0,onClick:()=>{g()},children:"取消支付"}),d.jsx(I,{type:"primary",onClick:()=>{g()},children:"支付完成了"})]})})]})})]})})}):d.jsx("div",{style:{width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:d.jsx(D,{rotate:!0,width:"3em",height:"3em"})})}export{ft as default};
